language: node_js
services:
- docker
env:
  global:
  - secure: TRYe7F7+0ospi630/ooJChzGEMW7Y6u33V7Cqy934+EE6q8xt2sc7k2FwfFrlZw5jgrHid9GW18eUJvZVYPWLFdL5dH+Q0OrpR3ljHNbDXjBsexqZey2sRYKFuH0o/dq7kZwxG6b6QGnVX1Nrim1bV9RMgNVF5SIMzoRWbhDDjPYcG4slNqKID1Y9/36KTMa9fNkttoPUc3+aKnTLpPrv7K2uQaUS6CJ1/plgAtRsnxz5OgiTkoWVNYitkQr85ZHP8WLTcsZqTTvKXNNL+o/IgTB17Jxk5ysUhGN/mihJTuvb8VAFRwPpI6c7NakGchGTBFzwvPAeTa1Ng+eAhs1YayXP/F70CCQAGtJHQQG0TYNxBVwzpIjD0ZzJCHmQs6Irr+KYMMKe4mdv9wWSVmEPEuW4m7Pwim8ODx4TQAuDTUJ9CtVx8kEUZ6LxRYLhoWqoMQWbo9ck2KAOW5o/BS9hGmy0Vu8PKOOOkOJ/xbVTXXSpaIb4949HJkcV6BiR8/2GD7HFclBClHCC0QXKoTSd5DoKFsbt89DFIfqm+eLW1xrbNM8KrjqxyEFowWSQYYbmOuwsBwrlda5Z8Nn6V5kSl0mSUzBSKxi0Je51cJbBCBhS10JJAczVzUQG5M442jXXpmEm6CJZyyE9mCONcuo/nyLRBmig7hq5stth4kif88=
  - secure: sP8fi1nRKN89uNqsR81WXXwwMB+FIxBPK8VmOQN4D5W4rDss+ZLEa/P2TlvlCTRBN1vrG+nD5G719uvx+V8YB2h3TmlNFKeIwfRmrnhKAStHvQVIgHkfwLKH8W4Z8mxd4L7bhqGPCH0fqgrUZ5lSnnNvs7054kS3wBY28MtO6b/y6vRNcjAf0i0FV7KGYOoN/Ag6ev0apYZSjSzWX53YwdMPwM/5jxjJUat88mRwRXmyCv1WdIQr0rD71sbJLcofroiYtE5zUed0o3ZWLlkDKRwQVDifazO7bURpSS2QvKSLmFyKzCfDQQZs5eTYRlwxVujfhhjgqPG4/tkzaPPnuzBsBN37+hDcGMIlUxJT7HWEsRC6oHiT7X3pZiuBW6JvisfHt2v9XW+h/JYb++gt/lu5DZIitqrVRShdq3anJ32H5f+JDmrZeeRseWG4DhpG2RA4JMTU+3gFf0q/p2+J6WC9Z/m0OJyqPESn1qWrv2jP8Q4gpk3Zd3r/BtDiXtVQChE9YyoMnIhipNt4c+piz3GMjmditRqNuBd9LsxfPft+Dgb+OGboR8Sd5zn0CLpqCx9xvU4untsAXvFU94XbaEWMaFHdMryBhXTN49ohLfEMrpf2DmGSqnLrtH+o2ecP9cLbEbo1mGdW+p3qQQWL8zDYwx3ixv3uy2IvigDln48=
  - secure: MHbtgVjTpIU02DXiyGJ3nzIuqMAn0IdQc/mTbPx+0XnvPL8RLq+gaHUEpZqIHHTSdzeBfEJZquUos/iWmRuQo0wTZGzWjLt8Y/DVBlK9zGFN08qyVp/m9bpWF7627P1g4vBFcVB9paXH+MuvBbOQxWxjB4+mQ6emwK/8bfYya2N6GnZaxp5spseOUMyS0zQ7TXB3veRH3TY6F1Wm1p2MU17zmfbiRpZlDoXbOFy4vNuHYbh1H5/63QGhzQpqyPrBbAiOm0n+fQdHJJvVOyoljCcRXQWMhilHz/1cw7tsYv9tAkc0JWYpZVlYNRU8w+Dh/A3bb8WVVrhRhObirZ6IliHRVvRKL+CvkFrja5bsjCEzC5/bN6H/D3qfkTQ789urSADEO6LvAKkeqI3pDb5P+x0Dcnei/pK1z7wQdGd89zAMCJ8HcdJ4NeBAMDuGUEGGPGOYOS8/+Gga+u0bqkWlZtVbj11z3iWmaKBdmWsV3nhAOXBEn4fC+DGqKMn/4aebNiwPiiSYW221iSVRT4qzV9fkylbRT4BZmgt4XRL4vvcpwMoLnUEaRSSx1jVBbEEBI0zmkzGS7SV2PGaQ/9TbiTcUOl71n1lNYsD9YIVq8fS3iWOHgNC5BrlZCP6cfP2gzl8sV1AYlOie/up60Z6KO0J0if6BmgBa7PcAzWlCof8=
  - DOCKER_IMAGE_NAME=CremALex/horizon-with-docker
  - COMMIT=${TRAVIS_COMMIT::8}
after_success:
  - docker login -e="$DOCKER_EMAIL" -u="$DOCKER_USER" -p="$DOCKER_PASS"
  - docker build -f Dockerfile -t $DOCKER_IMAGE_NAME .
  - if [ ! -z "$TRAVIS_TAG" ]; then
      docker tag $DOCKER_IMAGE_NAME:latest $DOCKER_IMAGE_NAME:$TRAVIS_TAG;
    fi
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
      docker push $DOCKER_IMAGE_NAME;
    fi